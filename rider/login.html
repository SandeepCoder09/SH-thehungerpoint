<!-- rider/login.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Rider Login â€” SH</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
</head>
<body>
  <div class="card">
    <h2>Rider Login</h2>
    <input id="identifier" placeholder="Email or phone" />
    <input id="password" placeholder="Password" type="password" />
    <button id="btnLogin">Sign in</button>
    <div class="muted">Make sure your rider record exists and is approved in Firestore.</div>
  </div>

  <script>
    const SERVER_URL = "https://sh-thehungerpoint.onrender.com";
    const btn = document.getElementById("btnLogin");
    btn.addEventListener("click", async () => {
      const identifier = document.getElementById("identifier").value.trim();
      const password = document.getElementById("password").value.trim();
      if (!identifier || !password) return alert("Enter credentials");

      btn.textContent = "Signing in...";
      try {
        const res = await fetch(`${SERVER_URL}/rider/login`, {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({ email: identifier, password, phone: identifier })
        });
        const j = await res.json();
        if (!j.ok) {
          alert(j.error || "Login failed");
          btn.textContent = "Sign in";
          return;
        }
        localStorage.setItem("riderToken", j.token);
        localStorage.setItem("riderId", j.riderId);
        location.href = "dashboard.html";
      } catch (e) {
        console.error(e);
        alert("Login error");
        btn.textContent = "Sign in";
      }
    });
  </script>
</body>
</html>